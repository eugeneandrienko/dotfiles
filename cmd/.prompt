LIGHTWHITE="\[\033[1;37m\]"
WHITE="\[\033[0;37m\]"
GREEN="\[\033[0;32m\]"
MAGENTA="\[\033[0;35m\]"
RED="\[\033[0;31m\]"
YELLOW="\[\033[0;33m\]"
BLACK="\[\033[0;30m\]"

SPEC_COLOR="$BLACK"
ADOG=$MAGENTA@$BLACK

function prompt {
    if [ $? -eq 0 ]; then
        PS1=""
    else
        PS1="$RED$? $BLACK"
    fi

    PS1PROMPT="$BLACK\u$ADOG\h: $GREEN\w$BLACK"
    GIT_BRANCH=`git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\1/'`
    if [ "$GIT_BRANCH" != "" ] && [ "$GIT_BRANCH" != "(no branch)" ]; then
        GIT_BRANCH=" ("$GIT_BRANCH")"
    else
        GIT_BRANCH=""
    fi
    GIT_TAG=`git describe --tags 2>/dev/null`
    if [ "$GIT_TAG" != "" ]; then
        GIT_TAG=" ["$GIT_TAG"]"
    fi

    PS1+="[`date +%H:%M:%S`] "
    PS1+=$PS1PROMPT
    PS1+=$GIT_BRANCH
    PS1+=$GIT_TAG
    PS1+="\n$SPEC_COLOR\$ "
    PS1+=$BLACK

    # Change terminal title
    if [ "$TERM" == "xterm" ]; then
        echo -ne "\033]0;$PWD\007"
    fi
}

PROMPT_COMMAND='prompt'
export PROMPT_COMMAND
export PS1

