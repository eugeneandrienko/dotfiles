source ~/.zshfunctions/_sync_common

OPTIONS="--update"

if [ -b /dev/sdc1 ]; then
    _mount_veracrypt /dev/sdc1 /media/DRIVESYNC
elif [ -b /dev/da0s1 ]; then
    _mount_veracrypt /dev/da0s1 /media/DRIVESYNC
else
    echo "No devices to store sync data"
    return
fi
_chown_mnt /media/DRIVESYNC

# remote -> local
_safe_dsync "$OPTIONS" /media/DRIVESYNC/rsync    ~/
_safe_dsync "$OPTIONS" /media/DRIVESYNC/dotfiles ~/git_repos
# local -> remote
_safe_dsync "$OPTIONS" ~/rsync              /media/DRIVESYNC/
_safe_dsync "$OPTIONS" ~/git_repos/dotfiles /media/DRIVESYNC/

if [ -b /dev/sdc1 ]; then
    _umount_veracrypt /dev/sdc1 /media/DRIVESYNC
elif [ -b /dev/da0s1 ]; then
    _umount_veracrypt /dev/da0s1 /media/DRIVESYNC
else
    echo "No devices to store sync data"
    return
fi
